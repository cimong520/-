# STM32F103C8T6 智能农业监控系统 - 完整硬件连接图

## 🔌 STM32F103C8T6 引脚分配表

| STM32引脚 | 功能模块 | 具体功能 | 连接说明 |
|-----------|----------|----------|----------|
| **3.3V** | 电源 | 正电源 | 所有模块VCC |
| **GND** | 电源 | 地线 | 所有模块GND |
| **PA0** | 蜂鸣器 | Buzzer控制 | 蜂鸣器正极 |
| **PA1** | 继电器 | Relay控制 | 继电器控制端 |
| **PA2** | ESP8266 | USART2_TX | ESP8266 RX |
| **PA3** | ESP8266 | USART2_RX | ESP8266 TX |
| **PA7** | 土壤湿度传感器 | ADC1_CH7 | 传感器AO输出 |
| **PA9** | 串口调试 | USART1_TX | USB转TTL RX |
| **PA10** | 串口调试 | USART1_RX | USB转TTL TX |
| **PA15** | 按键1 | KEY1 | 按键1 |
| **PB3** | 按键2 | KEY2 | 按键2 |
| **PB4** | 按键3 | KEY3 | 按键3 |
| **PB5** | 按键4 | KEY4 | 按键4 |
| **PB6** | BH1750光照传感器 | I2C_SCL | BH1750 SCL |
| **PB7** | BH1750光照传感器 | I2C_SDA | BH1750 SDA |
| **PB8** | OLED显示屏 | I2C_SCL | OLED SCL |
| **PB9** | OLED显示屏 | I2C_SDA | OLED SDA |
| **PB12** | DHT11温湿度传感器 | DATA | DHT11 DATA |

## 🖼️ 硬件连接示意图

```
                    STM32F103C8T6 最小系统板
    ┌─────────────────────────────────────────────────────────┐
    │                                                         │
    │  3.3V ●────────────────────── VCC (所有模块)            │
    │  GND  ●────────────────────── GND (所有模块)            │
    │                                                         │
    │  PA0  ●──────────────────────── 蜂鸣器 (+)              │
    │  PA1  ●──────────────────────── 继电器控制端            │
    │  PA2  ●──────────────────────── ESP8266 (RX)           │
    │  PA3  ●──────────────────────── ESP8266 (TX)           │
    │  PA7  ●──────────────────────── 土壤湿度传感器 (AO)     │
    │  PA9  ●──────────────────────── USB转TTL (RX)          │
    │  PA10 ●──────────────────────── USB转TTL (TX)          │
    │  PA15 ●──────────────────────── 按键1                  │
    │                                                         │
    │  PB3  ●──────────────────────── 按键2                  │
    │  PB4  ●──────────────────────── 按键3                  │
    │  PB5  ●──────────────────────── 按键4                  │
    │  PB6  ●──────────────────────── BH1750 (SCL)          │
    │  PB7  ●──────────────────────── BH1750 (SDA)          │
    │  PB8  ●──────────────────────── OLED (SCL)            │
    │  PB9  ●──────────────────────── OLED (SDA)            │
    │  PB12 ●──────────────────────── DHT11 (DATA)          │
    │                                                         │
    └─────────────────────────────────────────────────────────┘
```

## 📱 各模块详细连接

### 1. 🔊 蜂鸣器模块
```
蜂鸣器模块        STM32F103C8T6
    VCC    ──────    3.3V
    GND    ──────    GND
    I/O    ──────    PA0
```

### 2. 🔌 继电器模块
```
继电器模块        STM32F103C8T6
    VCC    ──────    3.3V (或5V)
    GND    ──────    GND
    IN     ──────    PA1
```

### 3. 📡 ESP8266 WiFi模块
```
ESP8266模块       STM32F103C8T6
    VCC    ──────    3.3V
    GND    ──────    GND
    TX     ──────    PA2 (USART2_TX)
    RX     ──────    PA3 (USART2_RX)
    EN     ──────    3.3V (使能)
```

### 4. 🌱 土壤湿度传感器
```
土壤湿度传感器     STM32F103C8T6
    VCC    ──────    3.3V
    GND    ──────    GND
    AO     ──────    PA7 (ADC1_CH7) ← 重要修改！
    DO     ──────    (不连接)
```

### 5. 🌡️ DHT11 温湿度传感器
```
DHT11传感器       STM32F103C8T6
    VCC    ──────    3.3V
    GND    ──────    GND
    DATA   ──────    PB12
```

### 6. ☀️ BH1750 光照传感器
```
BH1750传感器      STM32F103C8T6
    VCC    ──────    3.3V
    GND    ──────    GND
    SCL    ──────    PB6
    SDA    ──────    PB7
    ADDR   ──────    GND (地址选择)
```

### 7. 📺 OLED显示屏 (0.96寸 I2C)
```
OLED显示屏        STM32F103C8T6
    VCC    ──────    3.3V
    GND    ──────    GND
    SCL    ──────    PB8
    SDA    ──────    PB9
```

### 8. 🔘 按键模块
```
按键1            STM32F103C8T6
一端   ──────    PA15
另一端 ──────    GND

按键2            STM32F103C8T6
一端   ──────    PB3
另一端 ──────    GND

按键3            STM32F103C8T6
一端   ──────    PB4
另一端 ──────    GND

按键4            STM32F103C8T6
一端   ──────    PB5
另一端 ──────    GND
```

### 9. 💻 调试串口 (USB转TTL)
```
USB转TTL模块      STM32F103C8T6
    VCC    ──────    3.3V
    GND    ──────    GND
    RX     ──────    PA9 (USART1_TX)
    TX     ──────    PA10 (USART1_RX)
```

## ⚠️ 重要修改说明

### 🔴 关键变更：土壤湿度传感器引脚
- **修改前**: PA2 (与ESP8266冲突)
- **修改后**: PA7 (ADC1_CH7)

### 📋 修改对比表
| 模块 | 原引脚 | 新引脚 | 状态 |
|------|--------|--------|------|
| ESP8266 TX | PA2 | PA2 | ✅ 保持 |
| ESP8266 RX | PA3 | PA3 | ✅ 保持 |
| 土壤湿度传感器 | PA2 | **PA7** | 🔄 已修改 |

## 🔧 接线检查清单

- [ ] 所有模块VCC连接到STM32的3.3V
- [ ] 所有模块GND连接到STM32的GND
- [ ] 土壤湿度传感器AO连接到**PA7**（不是PA2！）
- [ ] ESP8266 TX连接到PA2，RX连接到PA3
- [ ] DHT11 DATA连接到PB12
- [ ] BH1750 SCL连接到PB6，SDA连接到PB7
- [ ] OLED SCL连接到PB8，SDA连接到PB9
- [ ] 按键正确连接到对应引脚
- [ ] 继电器控制端连接到PA1
- [ ] 蜂鸣器正极连接到PA0

## 🚀 测试建议

1. **先测试基础功能**：OLED显示、按键响应
2. **再测试传感器**：DHT11温湿度、土壤湿度
3. **最后测试通信**：ESP8266 WiFi连接
4. **验证控制功能**：继电器、蜂鸣器

按照这个连接图，您的智能农业监控系统就能正常工作了！